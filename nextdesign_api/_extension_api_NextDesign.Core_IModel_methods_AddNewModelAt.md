IModel.AddNewModelAt メソッド
=========================

名前空間: NextDesign.Core

説明​
-----------------------

このインスタンスの指定したフィールドに、追加位置を指定して指定したクラスのインスタンスをフィールド値として追加します。  
指定したクラスが抽象クラスの場合でもインスタンス化を許容し、指定した位置にフィールド値として追加します。  
指定するフィールドは、クラス型の所有フィールドでなければなりません。  
なお、多重度が2以上のフィールドの多重度上限制約に違反しても例外はスローされません。

指定するクラス名は、フィールドのデータ型と互換する型を指定する必要があります。  
また、あいまい一致とするときに、一致するクラスが複数ある場合、一番最初に見つかった型互換のあるクラスのインスタンスを追加します。

引数​
-----------------------

名前

型

説明

fieldName

string

フィールド名  
null、または空文字列は指定できません。

className

string

クラス名  
クラスの名前、または完全修飾名を指定します。  
null、または空文字列は指定できません。

direction

string

追加方向  
\- "first" : 先頭  
\- "last" : 末尾  
\- "before" : 前  
\- "after" : 後

index

int

追加基準位置  
先頭位置を0とするインデックスを指定します。  
direction の指定が "first"の場合は、インデックスの値に関係なく先頭に追加します。  
direction の指定が"last"の場合は、インデックスの値に関係なく末尾に追加します。  
direction の指定が "before"の場合は、指定された位置に、"after"の場合は、指定された位置の次の位置にインスタンスを追加します。

fuzzy

bool

あいまい一致オプション  
className引数を、完全修飾名ではなくクラスの名前として扱うかどうか。  
Falseの場合、完全修飾名がclassNameに一致するクラスを指定したものとして評価します。  
Trueの場合、クラス名がclassNameに一致するクラスを指定したものとして評価します。  
  
既定値はTrueです。

戻り値​
--------------------------

*   [IModel](_extension_api_NextDesign.Core_IModel.md)

例外​
-----------------------

名前

例外クラス

説明

引数不正

ExtensionArgumentException

fieldName、または className に null、または空文字列 を指定した場合  
direction に既定の文字列以外の文字列が指定された場合

フィールドが見つからない

ExtensionFieldNotFoundException

指定されたフィールドがこのインスタンスのメタクラスで見つからない場合

不正フィールドアクセス

ExtensionIllegalFieldAccessException

多重度の上限が1のフィールドに対してこのメソッドを実行した場合

インデックス範囲不正

ExtensionOutOfRangeException

index に 負数が指定された場合  
または、index に該当フィールドの要素数以上の値が指定された場合

指定フィールド不正

ExtensionInvalidTypeException

指定されたフィールドに設定できない値が指定された場合  
\- 指定されたフィールドが所有フィールドでない  
\- 指定されたフィールドのデータ型がクラス型でない  
\- 指定されたフィールドの型と指定されたクラスが互換しない

クラスが見つからない

ExtensionTypeNotFoundException

指定されたクラスが見つからない場合

不正操作

ExtensionInvalidOperationException

自身が削除済みモデル、一時プロキシの場合  
フィールド名に操作不可のフィールドが指定された場合  
\- プロダクトラインのフィーチャ割り当てフィールド  
\- System.Coreタグが付与されているフィールド  
無効なフィールドが指定された場合